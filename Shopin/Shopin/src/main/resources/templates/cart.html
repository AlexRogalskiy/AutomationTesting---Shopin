<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5">
    <head>                
        <title>Shopin</title>

        <script th:inline="javascript">
            cartName = [[${#authentication.name}]];
            cartName = cartName.replace(/[^a-zA-Z 0-9]+/g, '');
            cartName = cartName.replace(/\s/g, '');
            syncornot = null;
        </script> 

        <script src="js/jquery.min.js"></script>  
        <script src="js/simpleCart.min.js"></script>
        <script th:inline="javascript">

            simpleCart.bind('ready', function () {
            var isnull = [[${shoppingcart eq null}
            ]];
            if (isnull) {
            cartForm();
            } else {
            document.getElementsByTagName('body')[0].style.display = "block";
            }
            });
            function cartForm() {
            var serialize_items = "";
            simpleCart.each(function (item) {
            if (serialize_items.indexOf(item.get("msku")) == - 1) {
            serialize_items = serialize_items + item.get("msku") + ",";
            }
            });
            if (serialize_items.length > 0) {
            serialize_items = serialize_items.substring(0, serialize_items.length - 1);
            document.getElementById("cartContentId").value = serialize_items;
            document.forms["cartFormId"].submit();
            } else {
            var tableDiv = document.getElementById("tableDivAlterId");
            tableDiv.innerHTML = '<div class="alert alert-danger" role="alert" style="text-align: center;"><strong>Your shopping cart </strong>is empty!</div>';
            document.getElementsByTagName('body')[0].style.display = "block";
            }
            }
        </script>

        <link href="../css/bootstrap.css" rel="stylesheet" type="text/css" media="all" />
        <!-- Custom Theme files -->
        <!--theme-style-->
        <link href="../css/style.css" rel="stylesheet" type="text/css" media="all" />
        <!--//theme-style-->
        <meta name="viewport" content="width=device-width, initial-scale=1"/>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="keywords" content="Shopin Responsive web template, Bootstrap Web Templates, Flat Web Templates, AndroId Compatible web template,
              Smartphone Compatible web template, free webdesigns for Nokia, Samsung, LG, SonyEricsson, Motorola web design" />
        <script type="application/x-javascript"> addEventListener("load", function() { setTimeout(hideURLbar, 0); }, false); function hideURLbar(){ window.scrollTo(0,1); } </script>
        <!--theme-style-->
        <link href="css/style4.css" rel="stylesheet" type="text/css" media="all" />
        <!--//theme-style-->        
        <script src="js/bootbox.min.js"></script>
    </head>
    <body style="display:none;">
        <!--header-->
        <div class="header">
            <div class="container">
                <div class="head">
                    <div class=" logo">
                        <a href="/"><img src="images/logo.png" alt=""/></a>
                    </div>
                </div>
            </div>
            <div class="header-top">
                <div class="container">
                    <div class="col-sm-7 col-md-offset-2  header-login">
                        <ul >
                            <li><a href="/login">Login</a></li>
                            <li><a href="/register">Register</a></li>
                            <li><a onclick="cartForm();" style="cursor:pointer;">Cart</a></li>
                            <li>
                                <div style="color: sienna;" class="vizi">
                                    &nbsp;&nbsp;&nbsp;&nbsp;
                                    Login:
                                    <strong sec:authorize="!isAuthenticated()">
                                        <a style="color: tomato;" href="/login">
                                            guest
                                        </a>
                                    </strong>
                                    <strong sec:authorize="isAuthenticated()">
                                        <a style="color: tomato;" href="#">
                                            <span sec:authentication="name"></span>
                                        </a>
                                        &nbsp;|&nbsp;
                                        <a style="color: whitesmoke; cursor:pointer;" onclick="logoutJS();">
                                            Logout
                                        </a>
                                    </strong>
                                </div>
                            </li>
                        </ul>
                    </div>

                    <div class="col-sm-3 header-social">
                        <ul>
                            <li><a href="#"><i></i></a></li>
                            <li><a href="#"><i class="ic1"></i></a></li>
                            <li><a href="#"><i class="ic3"></i></a></li>                            
                        </ul>
                    </div>
                    
                    <div class="clearfix"> </div>
                </div>
            </div>

            <div class="container">

                <div class="head-top">

                    <div class="col-sm-8 col-md-offset-2 h_menu4">
                        <nav class="navbar nav_bottom" role="navigation">

                            <!-- Brand and toggle get grouped for better mobile display -->
                            <div class="navbar-header nav_2">
                                <button type="button" class="navbar-toggle collapsed navbar-toggle1" data-toggle="collapse" data-target="#bs-megadropdown-tabs">
                                    <span class="sr-only">Toggle navigation</span>
                                    <span class="icon-bar"></span>
                                    <span class="icon-bar"></span>
                                    <span class="icon-bar"></span>
                                </button>

                            </div>
                            <!-- Collect the nav links, forms, and other content for toggling -->
                            <div class="collapse navbar-collapse" id="bs-megadropdown-tabs">
                                <ul class="nav navbar-nav nav_1">
                                    <li><a class="color" href="/">Home</a></li>

                                    <li class="dropdown mega-dropdown active">
                                        <a href="#" class="color1 dropdown-toggle" data-toggle="dropdown">Women<span class="caret"></span></a>
                                        <div class="dropdown-menu">
                                            <div class="menu-top">
                                                <div class="col1">
                                                    <div class="h_nav">
                                                        <h4>
                                                            <a class="hrefs" th:href="@{products/1(category=f,range=im)}">
                                                                Clothing
                                                            </a>
                                                        </h4>
                                                        <ul>
                                                            <th:block th:each="category : ${categories}">
                                                                <li class="cats" th:if="${category.main == 'f' and category.type == 'im'}">
                                                                    <a th:href="@{products/1(category=f,id=${category.id},name=${#strings.replace(category.category, ' ', '-')})}" th:text="${category.category}"/>
                                                                </li>
                                                            </th:block>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="col1">
                                                    <div class="h_nav">
                                                        <h4>
                                                            <a class="hrefs" th:href="@{products/1(category=f,range=in)}">
                                                                Footwear
                                                            </a>
                                                        </h4>
                                                        <ul>
                                                            <th:block th:each="category : ${categories}">
                                                                <li class="cats" th:if="${category.main == 'f' and category.type == 'in'}">
                                                                    <a th:href="@{products/1(category=f,id=${category.id},name=${#strings.replace(category.category, ' ', '-')})}" th:text="${category.category}"/>
                                                                </li>
                                                            </th:block>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="col1">
                                                    <div class="h_nav">
                                                        <h4>
                                                            <a class="hrefs" th:href="@{products/1(category=f,range=ac)}">
                                                                Accessory
                                                            </a>   
                                                        </h4>
                                                        <ul>
                                                            <th:block th:each="category : ${categories}">
                                                                <li class="cats" th:if="${category.main == 'f' and category.type == 'ac'}">
                                                                    <a th:href="@{products/1(category=f,id=${category.id},name=${#strings.replace(category.category, ' ', '-')})}" th:text="${category.category}"/>
                                                                </li>
                                                            </th:block>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="col1">
                                                    <img src="images/me.png" class="img-responsive" alt=""/>
                                                </div>
                                                <div class="clearfix"></div>
                                            </div>
                                        </div>
                                    </li>
                                    <li class="dropdown mega-dropdown active">
                                        <a href="#" class="color1 dropdown-toggle" data-toggle="dropdown">Men<span class="caret"></span></a>
                                        <div class="dropdown-menu">
                                            <div class="menu-top">
                                                <div class="col1">
                                                    <div class="h_nav">
                                                        <h4>
                                                            <a class="hrefs" th:href="@{products/1(category=b,range=im)}">
                                                                Clothing
                                                            </a>
                                                        </h4>
                                                        <ul>
                                                            <th:block th:each="category : ${categories}">
                                                                <li class="cats" th:if="${category.main == 'b' and category.type == 'im'}">
                                                                    <a th:href="@{products/1(category=b,id=${category.id},name=${#strings.replace(category.category, ' ', '-')})}" th:text="${category.category}"/>
                                                                </li>
                                                            </th:block>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="col1">
                                                    <div class="h_nav">
                                                        <h4>
                                                            <a class="hrefs" th:href="@{products/1(category=b,range=in)}">
                                                                Footwear
                                                            </a>
                                                        </h4>
                                                        <ul>
                                                            <th:block th:each="category : ${categories}">
                                                                <li class="cats" th:if="${category.main == 'b' and category.type == 'in'}">
                                                                    <a th:href="@{products/1(category=b,id=${category.id},name=${#strings.replace(category.category, ' ', '-')})}" th:text="${category.category}"/>
                                                                </li>
                                                            </th:block>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="col1">
                                                    <div class="h_nav">
                                                        <h4>
                                                            <a class="hrefs" th:href="@{products/1(category=b,range=ac)}">
                                                                Accessory
                                                            </a>   
                                                        </h4>
                                                        <ul>
                                                            <th:block th:each="category : ${categories}">
                                                                <li class="cats" th:if="${category.main == 'b' and category.type == 'ac'}">
                                                                    <a th:href="@{products/1(category=b,id=${category.id},name=${#strings.replace(category.category, ' ', '-')})}" th:text="${category.category}"/>
                                                                </li>
                                                            </th:block>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="col1">
                                                    <img src="images/me1.png" class="img-responsive" alt=""/>
                                                </div>
                                                <div class="clearfix"></div>
                                            </div>
                                        </div>
                                    </li>
                                    <li class="dropdown mega-dropdown active">
                                        <a href="#" class="color1 dropdown-toggle" data-toggle="dropdown">Children<span class="caret"></span></a>
                                        <div class="dropdown-menu">
                                            <div class="menu-top">
                                                <div class="col1">
                                                    <div class="h_nav">
                                                        <h4>
                                                            <a class="hrefs" th:href="@{products/1(category=c,range=im)}">
                                                                Clothing
                                                            </a>
                                                        </h4>
                                                        <ul>
                                                            <th:block th:each="category : ${categories}">
                                                                <li class="cats" th:if="${category.main == 'c' and category.type == 'im'}">
                                                                    <a th:href="@{products/1(category=c,id=${category.id},name=${#strings.replace(category.category, ' ', '-')})}" th:text="${category.category}"/>
                                                                </li>
                                                            </th:block>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="col1">
                                                    <div class="h_nav">
                                                        <h4>
                                                            <a class="hrefs" th:href="@{products/1(category=c,range=in)}">
                                                                Footwear
                                                            </a>
                                                        </h4>
                                                        <ul>
                                                            <th:block th:each="category : ${categories}">
                                                                <li class="cats" th:if="${category.main == 'c' and category.type == 'in'}">
                                                                    <a th:href="@{products/1(category=c,id=${category.id},name=${#strings.replace(category.category, ' ', '-')})}" th:text="${category.category}"/>
                                                                </li>
                                                            </th:block>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="col1">
                                                    <div class="h_nav">
                                                        <h4>
                                                            <a class="hrefs" th:href="@{products/1(category=c,range=ac)}">
                                                                Accessory
                                                            </a>   
                                                        </h4>
                                                        <ul>
                                                            <th:block th:each="category : ${categories}">
                                                                <li class="cats" th:if="${category.main == 'c' and category.type == 'ac'}">
                                                                    <a th:href="@{products/1(category=c,id=${category.id},name=${#strings.replace(category.category, ' ', '-')})}" th:text="${category.category}"/>
                                                                </li>
                                                            </th:block>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="col1">
                                                    <img src="images/me2.png" class="img-responsive" alt=""/>
                                                </div>
                                                <div class="clearfix"></div>
                                            </div>
                                        </div>
                                    </li>                                    
                                    <li><a class="color6" href="/contact">Contact Us</a></li>
                                </ul>
                            </div><!-- /.navbar-collapse -->

                        </nav>
                    </div>
                    <div class="col-sm-2 search-right">
                        <ul class="heart">                           
                            <li><a class="play-icon popup-with-zoom-anim vizi" style="font-size: 16px; color: darkslategrey; text-decoration: none;" href="#small-dialog">Search&nbsp;<i class="glyphicon glyphicon-search"> </i></a></li>
                        </ul>
                        <div class="cart box_1" style="cursor: pointer;">
                            <a onclick="cartForm();" style="cursor:pointer; text-decoration: none !important;">
                                <h3> <div class="total">
                                        <span id="totalCartId" class="simpleCart_total"></span></div>
                                    <img src="images/cart.png" alt=""/></h3>
                            </a>
                            <p><a id="emptyCartId" href="javascript:;" onclick="emptyCart(true);" class="simpleCart_empty">Goleste cosul</a></p>                            
                        </div>
                        <div class="clearfix"> </div>

                        <!-- pop-up-box -->
                        <link href="css/popuo-box.css" rel="stylesheet" type="text/css" media="all"/>
                        <script src="js/jquery.magnific-popup.js" type="text/javascript"></script>
                        <!-- //pop-up-box -->
                        <div id="small-dialog" class="mfp-hide">
                            <div class="search-top">
                                <div class="login-search">
                                    <input type="submit" value="" onclick="document.location = 'http://' + document.location.host + '/products/1?search=' + $('#searchId').val()"/>
                                    <input type="text" id="searchId" value="Search products ..." onfocus="this.value = '';" onblur="if (this.value == '') {
                                        this.value = 'Search..';
                                        }"/>		
                                </div>
                                <p>Shopin</p>
                            </div>				
                        </div>
                        <script>
                            $(document).ready(function () {
                            $('.popup-with-zoom-anim').magnificPopup({
                            type: 'inline',
                                    fixedContentPos: false,
                                    fixedBgPos: true,
                                    overflowY: 'auto',
                                    closeBtnInside: true,
                                    preloader: false,
                                    midClick: true,
                                    removalDelay: 300,
                                    mainClass: 'my-mfp-zoom-in'
                            });
                            });
                        </script>

                    </div>
                    <div class="clearfix"></div>
                </div>
            </div>
        </div>
        <!--banner-->
        <div class="banner-top">
            <div class="container">
                <h1>Cart</h1>
                <em></em>
                <h2><a href="/">Home</a><label>/</label><a href="/login">Login</a></h2>
            </div>
        </div>
        <!--login-->
        <script>$(document).ready(function () {
            plafon = 10000;
            maxp = 100;
            maxop = 5;
            });
        </script>
        <script>$(document).ready(function (c) {
            $('.close1').on('click', function (c) {
            $('.cart-header').fadeOut('slow', function (c) {
            $('.cart-header').remove();
            });
            });
            });
        </script>
        <script>$(document).ready(function (c) {
            $('.close2').on('click', function (c) {
            $('.cart-header1').fadeOut('slow', function (c) {
            $('.cart-header1').remove();
            });
            });
            });
        </script>
        <script>$(document).ready(function (c) {
            $('.close3').on('click', function (c) {
            $('.cart-header2').fadeOut('slow', function (c) {
            $('.cart-header2').remove();
            });
            });
            });
        </script>
        <div id="tableDivId" style="margin-top: 5px;" th:if="${shoppingcart ne null and #lists.size(shoppingcart) eq 0}">
            <div class="alert alert-danger" role="alert" style="text-align: center;"><strong>Your cart </strong>is empty!</div>       
            <script>
                simpleCart.bind('ready', function () {
                simpleCart.empty();
                });
            </script>
        </div>   
        <div id="tableDivAlterId" style="margin-top: 5px;"></div>
        <div class="container" th:if="${shoppingcart ne null and #lists.size(shoppingcart) gt 0}">
            <div class="check-out" style="padding-top: 1em;">                
                <div class="bs-example4" data-example-id="simple-responsive-table">
                    <div class="table-responsive">
                        <table id="tableCartId" class="table-heading simpleCart_shelfItem">
                            <tr>
                                <th style="text-align: left;" class="table-grid">Item</th>
                                <th style="text-align: center;">Price/unit</th>
                                <th style="text-align: center;">Quantity</th>
                                <th style="text-align: center;">Discount</th>
                                <th style="text-align: center;">Subtotal</th>
                            </tr>
                            <tbody>
                                <script>
                                    serveritems = new Array();
                                </script>
                                <th:block th:each="item, position:${shoppingcart}">
                                    <script th:inline="javascript">
                                        // <![CDATA[                                        
                                        serveritems.push({sku:[[${item.sku}
                                        ]],
                                                discount: [[${item.discount}
                                                ]],
                                                image: [[${item.image
                                                }
                                                ]],
                                                price: [[${item.price
                                                }
                                                ]],
                                                sizes: [[${item.sizes
                                                }
                                                ]],
                                                name: [[${item.name
                                                }
                                                ]],
                                                live: [[${item.live
                                                }
                                                ]]
                                        }
                                        );
                                        // ]]>
                                    </script>
                                </th:block>

                                <script>
                                    $(document).ready(function () {

                                    plafon = 10000;
                                    maxp = 100;
                                    maxop = 5;
                                    localStorage.removeItem("simpleCart_extra");
                                    simpleCart.bind('ready', function () {
                                    simpleCart.currency({code: "EUR", name: "EUR", symbol: ""});
                                    var table = document.getElementById("tableCartId");
                                    var updateds = "The following products have been updated:<br/>";
                                    var updatedc = "";
                                    var updatede = "<br/><strong>Please check the updated product code and pages.</strong>";
                                    if (simpleCart.total() > plafon) {
                                    disableCartButton();
                                    document.getElementById("maxTotalId").style.visibility = "visible";
                                    }

                                    if (simpleCart.quantity() > maxp) {
                                    disableCartButton();
                                    document.getElementById("maxProdId").style.visibility = "visible";
                                    }

                                    simpleCart.each(function (item) {

                                    var row = table.insertRow(1);
                                    var lookupsku = item.get("msku");
                                    var lookupsize = item.get("msize");
                                    row.id = lookupsku + "-" + lookupsize;
                                    var found = 0;
                                    /*<![CDATA[*/
                                    for (j = 0; j < serveritems.length; j++) {
                                    if (serveritems[j].sku == lookupsku && serveritems[j].live == 1) {
                                    /*]]>*/
                                    found = 1;
                                    if ((serveritems[j].sizes).indexOf(lookupsize) != - 1) {
                                    var image = row.insertCell(0);
                                    image.className = "ring-in";
                                    var price = row.insertCell(1);
                                    price.style.textAlign = "center";
                                    var quantity = row.insertCell(2);
                                    quantity.style.textAlign = "center";
                                    var discount = row.insertCell(3);
                                    discount.style.textAlign = "center";
                                    var subtotal = row.insertCell(4);
                                    subtotal.style.textAlign = "center";
                                    subtotal.className = "item_price";
                                    subtotal.id = "sub-" + lookupsku + "-" + lookupsize;
                                    var path = "product?sku=" + lookupsku + "&amp;name=" + serveritems[j].name.replace(/\ /g, '-');
                                    image.innerHTML = '<a href="' + path + '" class="at-in"><img src="../../images' + serveritems[j].image + serveritems[j].sku + '/main_shopin.jpg" class="img-responsive" alt=""/></a>' +
                                            '<div class="sed"><h5><a href="' + path + '">' + serveritems[j].name + '</a></h5></div>';
                                    image.innerHTML += '<div class="sed"><p>Selected size:<strong>' + lookupsize.substring(0, lookupsize.lastIndexOf("-")) + '</strong></p></div>';
                                    var storedprice = parseFloat(item.get("price")).toFixed(2);
                                    var pricewithdiscount = parseFloat(serveritems[j].price - (serveritems[j].price * serveritems[j].discount) / 100).toFixed(2);
                                    var subtotalcal = item.get("quantity") * pricewithdiscount;
                                    if (pricewithdiscount == storedprice) {
                                    price.innerHTML = storedprice;
                                    if (serveritems[j].discount > 0) {
                                    discount.style.color = "red";
                                    discount.innerHTML = '-' + serveritems[j].discount + '%';
                                    } else {
                                    discount.innerHTML = '-';
                                    }
                                    } else {
                                    updatedc += "- <strong>" + serveritems[j].name + "</strong>, size: <strong>" + lookupsize + "</strong> (old price: <strong>" + storedprice + "</strong>, new price: <strong>" + pricewithdiscount + "</strong>)<br/>";
                                    price.innerHTML = pricewithdiscount;
                                    item.set("price", pricewithdiscount);
                                    simpleCart.update();
                                    if (simpleCart.total() > plafon) {
                                    disableCartButton();
                                    document.getElementById("maxTotalId").style.visibility = "visible";
                                    } else {
                                    enableCartButton();
                                    document.getElementById("maxTotalId").style.visibility = "hidden";
                                    }
                                    }

                                    var idv = "v-" + lookupsku + "-" + lookupsize;
                                    var idp = "p-" + lookupsku + "-" + lookupsize;
                                    var idm = "m-" + lookupsku + "-" + lookupsize;
                                    quantity.innerHTML = '<div class="quantity" style="width: 100%;"><div class="quantity-select"><div id="' + idm + '" class="entry value-minus">&nbsp;</div><div id="' + idv + '" class="entry value">' + item.get("quantity") + '</div><div id="' + idp + '" class="entry value-plus active">&nbsp;</div></div></div>';
                                    $('#' + idp).on('click', function () {
                                    var divUpd = $(this).parent().find('.value');
                                    /*<![CDATA[*/
                                    if (parseInt(divUpd.text(), 10) < maxop) {
                                    /*]]>*/
                                    newVal = parseInt(divUpd.text(), 10) + 1;
                                    divUpd.text(newVal);
                                    var itemmod = simpleCart.find({msku: lookupsku, msize: lookupsize});
                                    itemmod[0].quantity(newVal);
                                    document.getElementById('sub-' + lookupsku + "-" + lookupsize).innerHTML = parseFloat(newVal * itemmod[0].get("price")).toFixed(2);
                                    simpleCart.update();
                                    if (simpleCart.total() > plafon) {
                                    disableCartButton();
                                    document.getElementById("maxTotalId").style.visibility = "visible";
                                    }

                                    if (simpleCart.quantity() > maxp) {
                                    disableCartButton();
                                    document.getElementById("maxProdId").style.visibility = "visible";
                                    }

                                    localStorage.removeItem("simpleCart_extra");
                                    }
                                    if (parseInt(divUpd.text(), 10) >= maxop) {
                                    var plusBtn = document.getElementById(idp);
                                    plusBtn.className += " disabled";
                                    }
                                    });
                                    $('#' + idm).on('click', function () {
                                    var divUpd = $(this).parent().find('.value'), newVal = parseInt(divUpd.text(), 10) - 1;
                                    var plusBtn = document.getElementById(idp);
                                    plusBtn.className = "entry value-plus active";
                                    if (newVal >= 1) {
                                    divUpd.text(newVal);
                                    var itemmod = simpleCart.find({msku: lookupsku, msize: lookupsize});
                                    itemmod[0].quantity(newVal);
                                    document.getElementById('sub-' + lookupsku + "-" + lookupsize).innerHTML = parseFloat(newVal * itemmod[0].get("price")).toFixed(2);
                                    simpleCart.update();
                                    /*<![CDATA[*/
                                    if (simpleCart.total() <= plafon) {
                                    document.getElementById("maxTotalId").style.visibility = "hidden";
                                    }

                                    if (simpleCart.quantity() <= maxp) {
                                    document.getElementById("maxProdId").style.visibility = "hidden";
                                    }
                                    if (simpleCart.total() <= plafon && simpleCart.quantity() <= maxp) {
                                    enableCartButton();
                                    }
                                    localStorage.removeItem("simpleCart_extra");
                                    /*]]>*/
                                    }
                                    });
                                    image.innerHTML += '<div class="clearfix"></div><div class="close1" style="cursor: pointer;" onclick="removeItem(\'' + serveritems[j].sku + '\',\'' + lookupsize + '\',\'' + true + '\')"></div>';
                                    subtotal.innerHTML = parseFloat(subtotalcal).toFixed(2);
                                    } else {
                                    removeProduct("Marime indisponibla!", j, row, lookupsize);
                                    break;
                                    }
                                    break;
                                    }
                                    /*<![CDATA[*/
                                    if (serveritems[j].sku == lookupsku && serveritems[j].live == 0) {
                                    /*]]>*/
                                    found = 1;
                                    removeProduct("Product currently unavailable!", j, row, lookupsize);
                                    break;
                                    }
                                    }
                                    if (found == 0) {
                                    removeItem(lookupsku, lookupsize, true);
                                    }
                                    });
                                    if (simpleCart.total() > plafon) {
                                    disableCartButton();
                                    document.getElementById("maxTotalId").style.visibility = "visible";
                                    }

                                    if (simpleCart.quantity() > maxp) {
                                    disableCartButton();
                                    document.getElementById("maxProdId").style.visibility = "visible";
                                    }

                                    if (updatedc.length > 0) {
                                    bootbox.alert({
                                    title: "Updated products",
                                            message: updateds + updatedc + updatede,
                                            size: 'large',
                                            backdrop: true
                                    });
                                    }
                                    });
                                    });
                                    function removeProduct(msg, position, row, lookupsize) {
                                    var image = row.insertCell(0);
                                    image.className = "ring-in";
                                    image.style.backgroundColor = "#BADCF6";
                                    var indisp = row.insertCell(1);
                                    indisp.style.textAlign = "center";
                                    indisp.style.backgroundColor = "#BADCF6";
                                    indisp.colSpan = 4;
                                    image.innerHTML = '<a class="at-in"><img src="../../images' + serveritems[position].image + '/' + serveritems[position].sku + '/main_shopin.jpg" class="img-responsive" alt=""/></a>' +
                                            '<div class="sed"><h5 style="color: black;">' + serveritems[position].name + '</h5></div>';
                                    image.innerHTML += '<div class="sed"><p>Selected size:<strong>' + lookupsize.substring(0, lookupsize.lastIndexOf("-")) + '</strong></p></div>';
                                    image.innerHTML += '<div class="clearfix"></div><div class="close1" style="cursor: pointer;" onclick="removeItem(\'' + serveritems[position].sku + '\',\'' + lookupsize + '\',\'' + true + '\')"></div>';
                                    indisp.innerHTML = '<p style="color:black;">' + msg + '</p>';
                                    // scoate din cart
                                    removeItem(serveritems[position].sku, lookupsize, false);
                                    localStorage.removeItem("simpleCart_extra");
                                    }

                                    function removeItem(msku, msize, flag) {
                                    if (flag) {
                                    var row = document.getElementById(msku + "-" + msize);
                                    row.parentNode.removeChild(row);
                                    }

                                    var itemToRem = simpleCart.find({msku: msku, msize: msize});
                                    if (itemToRem.length > 0) {
                                    itemToRem[0].remove();
                                    }
                                    if (simpleCart.quantity() == 0) {
                                    emptyCart(false);
                                    }
                                    }

                                    function emptyCart(all) {
                                    simpleCart.empty();
                                    localStorage.removeItem("simpleCart_extra");
                                    document.getElementById("maxProdId").style.visibility = "hidden";
                                    document.getElementById("maxTotalId").style.visibility = "hidden";
                                    document.getElementById("buyId").style.visibility = "hidden";
                                    disableCartButton();
                                    if ($("#tableCartId tr").length == 1 || all) {
                                    $("#tableCartId tr").remove();
                                    }
                                    var tableDiv = document.getElementById("tableDivAlterId");
                                    tableDiv.innerHTML = '<div class="alert alert-danger" role="alert" style="text-align: center;"><strong>Your cart </strong>is empty!</div>';
                                    }

                                    function disableCartButton() {
                                    document.getElementById("addrId").setAttribute("disabled", true);
                                    document.getElementById("addrId").style.cursor = "not-allowed";
                                    document.getElementById("addrId").style.opacity = "0.6";
                                    document.getElementById("addrId").style.pointerEvents = "none";
                                    }
                                    function enableCartButton() {
                                    document.getElementById("addrId").removeAttribute("disabled");
                                    document.getElementById("addrId").style.cursor = "pointer";
                                    document.getElementById("addrId").style.opacity = "1.0";
                                    document.getElementById("addrId").style.pointerEvents = "auto";
                                    }
                                </script>                                
                            </tbody>
                        </table>
                    </div>
                </div>
                <table style="width:100%;">                    
                    <tr>
                        <td style="text-align: center;">
                            <div id="totalDivId" class="total" style="color: black;">
                                Subtotal comanda: <strong><span id="totalCart2Id" class="simpleCart_total"></span></strong> EUR
                            </div>            
                        </td>    
                    </tr>                       
                    <tr>
                        <td style="text-align: center;">
                            <strong sec:authorize="!isAuthenticated()">
                                <a id="addrId" href="purchase" onclick="simpleCartExtra();">
                                    <button id="buyId" type="button" class="btn btn-lg btn-primary">Complete the order</button>                                                            
                                </a>                                
                            </strong>
                            <strong sec:authorize="isAuthenticated()">
                                <a id="addrId" href="ordermember" onclick="simpleCartExtra();">
                                    <button id="buyId" type="button" class="btn btn-lg btn-primary">Complete the order</button>                                                            
                                </a>                                
                            </strong>
                            <script th:inline="javascript">
                                function simpleCartExtra() {
                                localStorage.removeItem("simpleCart_extra");
                                var extraItem = "{";
                                simpleCart.each(function (item) {
                                var lookupsku = item.get("msku");
                                /*<![CDATA[*/
                                for (j = 0; j < serveritems.length; j++) {
                                if (serveritems[j].sku == lookupsku && serveritems[j].live == 1) {
                                /*]]>*/
                                if (extraItem.indexOf(lookupsku) == - 1) {
                                extraItem = extraItem + '"' + lookupsku + '":{"eimage":"' + serveritems[j].image + '","ename":"' + serveritems[j].name + '"},';
                                }
                                }
                                }
                                });
                                extraItem = extraItem.substring(0, extraItem.length - 1) + "}";
                                localStorage.setItem("simpleCart_extra", extraItem);
                                var authTitle = [[${#authentication.name}
                                ]];
                                if (authTitle != "anonymousUser") {
                                if (localStorage.getItem(cartName + "_addr")) {
                                document.getElementById("addrId").setAttribute("href", "/ordermember?addr=true");
                                } else {
                                document.getElementById("addrId").setAttribute("href", "/ordermember?addr=false");
                                }
                                }
                                }
                            </script>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: center;">
                            <p id="maxTotalId" style="color: red; visibility: hidden;"><strong> Orders larger than 10000 EUR cannot be placed</strong></p>
                            <p id="maxProdId" style="color: red; visibility: hidden;"><strong> No more than 100 products can be placed per order</strong></p>
                        </td>
                    </tr> 
                </table>                    
            </div>
        </div>

        <!--//footer-->
         <div class="footer">
            <div class="footer-middle">
                <div class="container">
                    <div class="col-md-3 footer-middle-in">
                        <a href="/"><img src="images/log.png" alt=""/></a>
                        <p>Explore the trends and buy pieces from the hottest collections, from jackets, jeans and dresses to sports blouses, knitwear, T-shirts and much more - available for you to create the perfect outfit.</p>
                    </div>

                    <div class="col-md-3 footer-middle-in">
                        <h6>Support and assistance</h6>
                        <ul class=" in">
                            <li><a href="404.html">About Us</a></li>
                            <li><a href="/contact">Payment methods</a></li>
                            <li><a href="#">Terms and conditions</a></li>
                            <li><a href="/contact">Delivery options</a></li>
                        </ul>
                        <ul class="in in1">
                            <li><a href="/login">Register</a></li>
                            <li><a href="/contact">Contact</a></li>
                            <li><a href="wishlist.html">Guarantee</a></li>
                        </ul>
                        <div class="clearfix"></div>
                    </div>
                    <div class="col-md-3 footer-middle-in">
                        <h6>Tags</h6>
                        <ul class="tag-in">
                            <li><a href="#">Shirts</a></li>
                            <li><a href="#">Coats</a></li>
                            <li><a href="#">Dresses</a></li>
                            <li><a href="#">T-shirts</a></li>
                            <li><a href="#">Pants</a></li>
                            <li><a href="#">Shoes</a></li>
                            <li><a href="#">Boots</a></li>
                        </ul>
                    </div>
                    <!--
                    <div class="col-md-3 footer-middle-in">
                        <h6>Newsletter</h6>
                        <span>Please enter your email address</span>
                        <form>
                            <input type="text" value="E-mail" onfocus="this.value = '';" onblur="if (this.value == '') {
                                this.value = 'E-mail';
                                }"/>
                            <input type="submit" value="Subscribe"/>
                        </form>
                    </div>
                    -->
                    <div class="clearfix"> </div>
                </div>
            </div>
              <div class="footer-bottom">
                <div class="container">
                    <ul class="footer-bottom-top">
                        <!--
                        <li><a href="#"><img src="images/f1.png" class="img-responsive" alt=""/></a></li>
                        <li><a href="#"><img src="images/f2.png" class="img-responsive" alt=""/></a></li>
                        <li><a href="#"><img src="images/f3.png" class="img-responsive" alt=""/></a></li>
                        -->
                    </ul>
                    <p class="footer-class">&copy; 2025 All rights reserved </p>
                    <div class="clearfix"> </div>
                </div>
            </div>
        </div>

        <form id="cartFormId" method="post" th:action="@{/cart}" th:object="${cartItems}" style="width: 0px; height: 0px; visibility: hidden;">
            <input id="cartContentId" type="hidden" th:field="*{items}" th:value="*{items}"/>
            <input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}"/>
        </form>       
        <script src="js/bootstrap.min.js"></script>         
        <script>
           document.getElementById("totalCartId").setAttribute("class", cartName + "_total");
           document.getElementById("totalCart2Id").setAttribute("class", cartName + "_total");
           document.getElementById("emptyCartId").setAttribute("class", cartName + "_empty");
           document.getElementById("tableCartId").setAttribute("class", cartName + "_shelfItem");
        </script>
        <script>
            function logoutJS() {
            document.forms["logoutForm"].submit();
            }
        </script>
        <form id="logoutForm" th:action="@{/logout}" method="POST">
            <input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}"/>
        </form>
    </body>
</html>